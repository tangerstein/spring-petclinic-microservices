!function(){function a(a){BOOMR.debug(a,"SPA")}var b,c=!1,d=!1,e=!1,f=!1,g=!1,h=!0,i=!1,j=!1,k=!1,l=[],m=!1;BOOMR=window.BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(!BOOMR.plugins.SPA&&BOOMR.plugins.AutoXHR){var n={spaHardMissedOnComplete:function(a){var b,c=BOOMR.plugins.RT&&BOOMR.plugins.RT.navigationStart();m=!1;BOOMR.addVar("spa.missed","1");BOOMR.plugins.RT&&BOOMR.plugins.RT.clearTimer("t_done");a.timing.requestStart=c;if(0===a.resources.length){b=BOOMR.getPerformance();b&&b.timing&&b.timing.navigationStart&&b.timing.loadEventEnd&&(a.timing.loadEventEnd=b.timing.loadEventEnd)}},onBeacon:function(){BOOMR.removeVar("spa.missed","spa.forced","spa.waiting")}};BOOMR.plugins.SPA={is_complete:function(){return!m},init:function(a){if(a&&a.instrument_xhr){g=a.instrument_xhr;e&&g&&BOOMR.plugins.AutoXHR.enableAutoXhr()}if(!d){d=!0;BOOMR.subscribe("beacon",n.onBeacon,null,n)}},register:function(a){l.push(a)},supported_frameworks:function(){return l},onLoadSpaHardMissed:function(){if(!e){f=!0;g&&BOOMR.plugins.AutoXHR.enableAutoXhr();m=!0;if(k)m=!1;else{BOOMR.fireEvent("spa_init",[BOOMR.plugins.SPA.current_spa_nav(),BOOMR.window.document.URL]);BOOMR.plugins.SPA.route_change(n.spaHardMissedOnComplete)}}},hook:function(b,d){d=d||{};a("Hooked");if(c)return this;"function"==typeof d.routeFilter&&(i=d.routeFilter);"function"==typeof d.routeChangeWaitFilter&&(j=d.routeChangeWaitFilter);d.disableHardNav&&(k=d.disableHardNav);b&&BOOMR.attach_page_ready(this.onLoadSpaHardMissed);c=!0;return this},route_change:function(c,d){a("Route Change");var l=!1;if(i)try{if(!i.apply(null,d)){a("Route filter returned false; not tracking this route");return}}catch(q){BOOMR.addError(q,"SPA.route_change.routeFilter")}e=!0;var m=BOOMR.plugins.RT&&BOOMR.plugins.RT.navigationStart(),n=f?BOOMR.now():m,o=BOOMR.window.document.URL,p={timing:{requestStart:n},initiator:h&&!k?"spa_hard":"spa",url:o};h=!1;if(!f||"function"==typeof c){f=!0;p.onComplete=function(a){if(!l){l=!0;BOOMR.fireEvent("spa_navigation")}"function"==typeof c&&c(a)}}if(j)try{if(j.apply(null,arguments)){p.wait=!0;b=p}}catch(q){BOOMR.addError(q,"SPA.route_change.routeChangeWaitFilter")}p.index=BOOMR.plugins.AutoXHR.getMutationHandler().addEvent(p);g&&BOOMR.plugins.AutoXHR.enableAutoXhr()},last_location:function(a){lastLocationChange=a},current_spa_nav:function(){return f?"spa":"spa_hard"},wait_complete:function(){if(b){b.wait=!1;b.waitComplete&&b.waitComplete();b=null}},markNavigationComplete:function(){a("Navigation being marked complete");var b=BOOMR.plugins.AutoXHR.getMutationHandler();if(b){BOOMR.addVar("spa.forced","1");BOOMR.addVar("spa.waiting",b.nodesWaitingFor());b.completeEvent()}}}}}();
//# sourceMappingURL=spa.min.js.map